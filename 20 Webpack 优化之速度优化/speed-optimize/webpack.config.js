// wepbacké€Ÿåº¦ä¼˜åŒ–

// è€ƒè™‘æ–¹å‘ï¼š
// ä¸€. ä»ä¼˜åŒ–æ„å»ºè¿‡ç¨‹æ¥è€ƒè™‘ï¼ˆä»pluginå’Œloaderå‚ä¸çš„æ„å»ºè¿‡ç¨‹æ¥è€ƒè™‘ï¼‰
// äºŒ. ä»å‹ç¼©æ–¹é¢æ¥è€ƒè™‘

// ä¼˜åŒ–æ„å»ºè¿‡ç¨‹ï¼š
// 1. Cache
// 2. å¤šçº¿ç¨‹
// 3. é¢„ç¼–è¯‘
// 4. å‡å°‘æŸ¥æ‰¾è¿‡ç¨‹

// ä¸‹é¢ä¸€ä¸€ä»‹ç»
// å‡å°‘æŸ¥æ‰¾è¿‡ç¨‹/æ‰¾å¾—æ›´å¿« ğŸ‘‰
// â‘  ä½¿ç”¨reasolve.aliaså‡å°‘æŸ¥æ‰¾/è§£æè¿‡ç¨‹
// â‘¡ ä½¿ç”¨resolve.extensionsä¼˜å…ˆæŸ¥æ‰¾
// â‘¢ ä½¿ç”¨module.noParseæ’é™¤ä¸éœ€è¦è§£æçš„æ¨¡å—
// â‘£ ä½¿ç”¨testã€includeã€excludeåˆç†é…ç½®ruleçš„æŸ¥æ‰¾èŒƒå›´/æ§åˆ¶æŸ¥æ‰¾èŒƒå›´

// å…¶ä»–æ„å»ºè¿‡ç¨‹çš„ä¼˜åŒ–ç‚¹
// sourceMap ç”Ÿæˆè€—æ—¶ä¸¥é‡ï¼Œæ ¹æ®ä¹‹å‰ sourceMap[TODO](sourcemap è¡¨æ ¼é“¾æ¥)è¡¨æ ¼é€‰æ‹©åˆé€‚çš„devtoolå€¼ï¼›
// åˆ‡æ¢ä¸€äº› loader æˆ–è€…æ’ä»¶ï¼Œæ¯”å¦‚ï¼šfast-sass-loaderå¯ä»¥å¹¶è¡Œå¤„ç† sass æ–‡ä»¶ï¼Œè¦æ¯” sass-loader å¿« 5~10 å€ï¼›

// åˆ©ç”¨å¤šçº¿ç¨‹æå‡æ„å»ºé€Ÿåº¦
// å¤šçº¿ç¨‹æ‰“åŒ…æœ‰ä¸¤ç§æ–¹æ¡ˆï¼šthread-loaderå’ŒHappyPackã€‚

// ä½¿ç”¨webpack.DLLPluginæ¥é¢„å…ˆç¼–è¯‘

// Cacheï¼š
// ä½¿ç”¨babel-loader é…ç½®cacheï¼ˆcacheDirectoryï¼‰

// åœ¨è¿™é‡Œæˆ‘ä»¬è¦åšçš„äº‹æƒ…æ˜¯èšç„¦ Webpack è¦å¤„ç†çš„ä»£ç ç›®å½•ï¼Œå¸®åŠ©ç¼©å° Webpack çš„æŸ¥æ‰¾è¿‡ç¨‹ã€‚

// ä½¿ç”¨ resolve.aliaså‡å°‘æŸ¥æ‰¾è¿‡ç¨‹
// resolve.alias é…ç½®é¡¹é€šè¿‡åˆ«åï¼ˆaliasï¼‰æ¥æŠŠåŸå¯¼å…¥è·¯å¾„æ˜ å°„æˆä¸€ä¸ªæ–°çš„å¯¼å…¥è·¯å¾„ã€‚æ¯”å¦‚æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„ react åº“ï¼Œå…¶å® react åº“ä¸­æœ‰ä¸¤å¥—ä»£ç ï¼Œä¸€å¥—æ˜¯åŸºäº CommonJs çš„æ¨¡å—åŒ–ä»£ç ï¼Œä¸€å¥—æ˜¯æ‰“åŒ…å¥½çš„å®Œæ•´ä»£ç ï¼Œreact.js ç”¨äºå¼€å‘ç¯å¢ƒï¼Œreact.min.js ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚æ‰€ä»¥é€šè¿‡ resolve.alias é…ç½®ï¼Œå¯ä»¥è®© Webpack å¤„ç†æ—¶ï¼Œç›´æ¥ä½¿ç”¨æ‰“åŒ…å¥½çš„ reactï¼Œä»è€Œè·³è¿‡è€—æ—¶çš„æ¨¡å—è§£æï¼Œè¿˜æœ‰æˆ‘ä»¬é¡¹ç›®ä¸­å¯èƒ½ä¼šæœ‰ä¸€äº›ç›¸å¯¹è·¯å¾„çš„å†™æ³•ï¼Œå¯ä»¥ä½¿ç”¨ alias é…ç½®æ¥å‡å°‘æŸ¥æ‰¾è¿‡ç¨‹ï¼Œå…·ä½“ç¤ºä¾‹é…ç½®å¦‚ä¸‹ï¼š

// module.exports = {
//   resolve: {
//     alias: {
//       // ä½¿ç”¨ alias æŠŠå¯¼å…¥ react çš„è¯­å¥æ¢æˆç›´æ¥ä½¿ç”¨å•ç‹¬å®Œæ•´çš„ react.min.js æ–‡ä»¶ï¼Œ
//       // å‡å°‘è€—æ—¶çš„é€’å½’è§£ææ“ä½œ
//       react: path.resolve(__dirname, "./node_modules/react/dist/react.min.js"),
//       // å‡å°‘ç›¸å¯¹è·¯å¾„çš„æŸ¥æ‰¾, æé«˜é€Ÿåº¦
//       "@lib": path.resolve(__dirname, "./src/lib/"),
//     },
//   },
// }

// ä½¿ç”¨ resolve.extensions ä¼˜å…ˆæŸ¥æ‰¾
// åœ¨å¯¼å…¥è¯­å¥æ²¡å¸¦æ–‡ä»¶åç¼€æ—¶ï¼ŒWebpack ä¼šè‡ªåŠ¨å¸¦ä¸Šåç¼€åå»å°è¯•è¯¢é—®æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼ŒæŸ¥è¯¢çš„é¡ºåºæ˜¯æŒ‰ç…§æˆ‘ä»¬é…ç½®çš„resolve.extensionsé¡ºåºä»å‰åˆ°åæŸ¥æ‰¾ï¼Œå¦‚æœæˆ‘ä»¬é…ç½® resolve.extensions= ['js', 'json']ï¼Œé‚£ä¹ˆä¼šå…ˆæ‰¾xxx.jsç„¶åæ²¡æœ‰å†æŸ¥æ‰¾xxx.jsonï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥æŠŠå¸¸ç”¨åˆ°çš„æ–‡ä»¶åç¼€å†™åœ¨å‰é¢ï¼Œæˆ–è€…æˆ‘ä»¬å¯¼å…¥æ¨¡å—æ—¶ï¼Œå°½é‡å¸¦ä¸Šæ–‡ä»¶åç¼€åã€‚

// æ’é™¤ä¸éœ€è¦è§£æçš„æ¨¡å—
// module.noParseé…ç½®é¡¹å¯ä»¥è®© Webpack å¿½ç•¥å¯¹éƒ¨åˆ†æ²¡é‡‡ç”¨æ¨¡å—åŒ–çš„æ–‡ä»¶é€’å½’è§£æå¤„ç†ï¼Œä¾‹å¦‚ï¼šjQueryã€ChartJSï¼Œå®ƒä»¬ä½“ç§¯åºå¤§åˆæ²¡æœ‰é‡‡ç”¨æ¨¡å—åŒ–æ ‡å‡†ï¼Œè®© Webpack å»è§£æè¿™äº›æ–‡ä»¶è€—æ—¶åˆæ²¡æœ‰æ„ä¹‰ï¼Œæ‰€ä»¥ä½¿ç”¨module.noParseæ’é™¤å®ƒä»¬ã€‚

// module.exports = {
//     module: {
//         noParse: /node_modules\/(jquey\.js)/;
//     }
// }
// Tipsï¼šè¢«å¿½ç•¥æ‰çš„æ–‡ä»¶é‡Œä¸åº”è¯¥åŒ…å« importã€requireã€define ç­‰æ¨¡å—åŒ–è¯­å¥ï¼Œä¸ç„¶ä¼šå¯¼è‡´æ„å»ºå‡ºçš„ä»£ç ä¸­åŒ…å«æ— æ³•åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹æ‰§è¡Œçš„æ¨¡å—åŒ–è¯­å¥ã€‚

// åˆç†é…ç½® rule çš„æŸ¥æ‰¾èŒƒå›´
// åœ¨ rule é…ç½®ä¸Šï¼Œæœ‰testã€includeã€excludeä¸‰ä¸ªå¯ä»¥æ§åˆ¶èŒƒå›´çš„é…ç½®ï¼Œæœ€ä½³å®è·µæ˜¯:

// åªåœ¨ test å’Œ æ–‡ä»¶ååŒ¹é…ä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼›
// åœ¨ include å’Œ exclude ä¸­ä½¿ç”¨ç»å¯¹è·¯å¾„æ•°ç»„ï¼›
// å°½é‡é¿å… excludeï¼Œæ›´å€¾å‘äºä½¿ç”¨ includeã€‚
// ç¤ºä¾‹é…ç½®ï¼š

// rules: [
//     {
//         // test ä½¿ç”¨æ­£åˆ™
//         test: /\.js$/,
//         loader: 'babel-loader',
//         // æ’é™¤è·¯å¾„ä½¿ç”¨æ•°ç»„
//         exclude: [path.resolve(__dirname, './node_modules')],
//         // æŸ¥æ‰¾è·¯å¾„ä½¿ç”¨æ•°ç»„
//         include: [path.resolve(__dirname, './src')]
//     }
// ];
// é¢„è§ˆ
// Tipsï¼šexcludeä¼˜å…ˆçº§è¦ä¼˜äºincludeå’Œtestï¼Œæ‰€ä»¥å½“ä¸‰è€…é…ç½®æœ‰å†²çªæ—¶ï¼Œexcludeä¼šä¼˜å…ˆäºå…¶ä»–ä¸¤ä¸ªé…ç½®ã€‚

// åˆ©ç”¨å¤šçº¿ç¨‹æå‡æ„å»ºé€Ÿåº¦
// ç”±äºè¿è¡Œåœ¨ Node.js ä¹‹ä¸Šçš„ Webpack æ˜¯å•çº¿ç¨‹æ¨¡å‹çš„ï¼Œæ‰€ä»¥ Webpack éœ€è¦å¤„ç†çš„äº‹æƒ…éœ€è¦ä¸€ä»¶ä¸€ä»¶çš„åšï¼Œä¸èƒ½å¤šä»¶äº‹ä¸€èµ·åšã€‚
// æˆ‘ä»¬éœ€è¦ Webpack èƒ½åŒä¸€æ—¶é—´å¤„ç†å¤šä¸ªä»»åŠ¡ï¼Œå‘æŒ¥å¤šæ ¸ CPU ç”µè„‘çš„å¨åŠ›ï¼ŒHappyPack å°±èƒ½è®© Webpack åšåˆ°è¿™ç‚¹ï¼Œå®ƒæŠŠä»»åŠ¡åˆ†è§£ç»™å¤šä¸ªå­è¿›ç¨‹å»å¹¶å‘çš„æ‰§è¡Œï¼Œå­è¿›ç¨‹å¤„ç†å®Œåå†æŠŠç»“æœå‘é€ç»™ä¸»è¿›ç¨‹ã€‚
// æˆ‘ä»¬çŸ¥é“ Node.js æ˜¯å•çº¿ç¨‹æ¨¡å‹çš„ï¼ŒWebpack è¿è¡Œåœ¨ Node.js ä¸Šå¤„ç†äº‹æƒ…æ˜¯ä¸€ä»¶ä»¶å¤„ç†çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ’ä»¶æ–¹å¼è®© Webpack æ”¯æŒå¤šä¸ªçº¿ç¨‹è¿›è¡ŒåŒæ—¶æ‰“åŒ…ï¼Œä»¥ä¾¿æé«˜ç¼–è¯‘æ‰“åŒ…çš„é€Ÿåº¦ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœé¡¹ç›®æ¯”è¾ƒç®€å•ï¼Œæ²¡æœ‰å¿…è¦é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œç®€å•çš„é¡¹ç›®ä½¿ç”¨å¤šçº¿ç¨‹ç¼–è¯‘æ‰“åŒ…åè€Œä¼šå› ä¸ºå¤šçº¿ç¨‹æ‰“åŒ…æµªè´¹æ›´å¤šçš„ CPU èµ„æºï¼Œè¿™æ ·æœ€ç»ˆç»“æœæ˜¯ä¸ä»…ä¸èƒ½åŠ å¿«æ‰“åŒ…çš„é€Ÿåº¦ï¼Œåè€Œä¼šé™ä½æ‰“åŒ…çš„é€Ÿåº¦ã€‚

// å¤šçº¿ç¨‹æ‰“åŒ…æœ‰ä¸¤ç§æ–¹æ¡ˆï¼šthread-loaderå’ŒHappyPackã€‚

// thread-loader
// thread-loader æ˜¯é’ˆå¯¹ loader è¿›è¡Œä¼˜åŒ–çš„ï¼Œå®ƒä¼šå°† loader æ”¾ç½®åœ¨ä¸€ä¸ª worker æ± é‡Œé¢è¿è¡Œï¼Œä»¥è¾¾åˆ°å¤šçº¿ç¨‹æ„å»ºã€‚thread-loader åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œéœ€è¦å°†å…¶æ”¾ç½®åœ¨å…¶ä»– loader ä¹‹å‰ï¼Œå¦‚ä¸‹é¢å®ä¾‹ï¼š

// // webpack.config.js

// module.exports = {
//     module: {
//         rules: [
//             {
//                 test: /\.js$/,
//                 include: path.resolve('src'),
//                 use: [
//                     'thread-loader'
//                     // ä½ çš„é«˜å¼€é”€çš„loaderæ”¾ç½®åœ¨æ­¤ (e.g babel-loader)
//                 ]
//             }
//         ]
//     }
// };

// HappyPack
// HappyPack æ˜¯é€šè¿‡å¤šè¿›ç¨‹æ¨¡å‹ï¼Œæ¥åŠ é€Ÿä»£ç æ„å»ºï¼Œå…·ä½“çš„åŸç†éƒ¨åˆ†å¯ä»¥çœ‹å®ƒçš„ä»‹ç»ï¼Œé‡Œé¢æœ‰ä¸ªè¯¦ç»†çš„æµç¨‹å›¾ï¼Œä¸‹é¢ç›´æ¥ä¸Šå®ƒçš„ç¤ºä¾‹ä»£ç ï¼š

// webpack.config.js
// const os = require('os');
// const HappyPack = require('happypack');
// æ ¹æ® cpu æ•°é‡åˆ›å»ºçº¿ç¨‹æ± 
// const happyThreadPool = HappyPack.ThreadPool({size: os.cpus().length});
// module.exports = {
//     module: {
//         rules: [
//             {
//                 test: /\.js$/,
//                 use: 'happypack/loader?id=jsx'
//             },

//             {
//                 test: /\.less$/,
//                 use: 'happypack/loader?id=styles'
//             }
//         ]
//     },
//     plugins: [
//         new HappyPack({
//             id: 'jsx',
//             // å¤šå°‘ä¸ªçº¿ç¨‹
//             threads: happyThreadPool,
//             loaders: ['babel-loader']
//         }),

//         new HappyPack({
//             id: 'styles',
//             // è‡ªå®šä¹‰çº¿ç¨‹æ•°é‡
//             threads: 2,
//             loaders: ['style-loader', 'css-loader', 'less-loader']
//         })
//     ]
// };
// Tipsï¼šç»™ loader é…ç½®ä½¿ç”¨ HappyPack éœ€è¦å¯¹åº”çš„ loader æ”¯æŒæ‰è¡Œï¼Œä¾‹å¦‚ url-loader å’Œ file-loader å°±ä¸æ”¯æŒ HappyPackï¼Œåœ¨ HappyPack çš„ wiki ä¸­æœ‰ä¸€ä»½æ”¯æŒ loader çš„åˆ—è¡¨ã€‚

// ä½¿ç”¨ webpack.DllPlugin æ¥é¢„å…ˆç¼–è¯‘
// é¢„å…ˆç¼–è¯‘å’Œæ‰“åŒ…ä¸ä¼šå˜åŠ¨å­˜åœ¨çš„æ–‡ä»¶ï¼Œåœ¨ä¸šåŠ¡ä»£ç ä¸­ç›´æ¥å¼•å…¥ï¼ŒåŠ å¿« Webpack ç¼–è¯‘æ‰“åŒ…çš„é€Ÿåº¦ï¼Œä½†æ˜¯å¹¶ä¸èƒ½å‡å°‘æœ€åç”Ÿæˆçš„ä»£ç ä½“ç§¯ã€‚

// ä¾‹å¦‚ä¸‹é¢ä»£ç ï¼š

// import React, {Component} from 'react';
// import ReactDOM, {render} from 'react-dom';
// ä½¿ç”¨äº† react å’Œ react-dom ä¸¤ä¸ªåº“ï¼Œè¿™ä¸¤ä¸ªåº“ä¸€èˆ¬æˆ‘ä»¬æ—¥å¸¸ä¸šåŠ¡ä»£ç å¼€å‘çš„æ—¶å€™å¹¶ä¸ä¼šå‡çº§ç‰ˆæœ¬æˆ–è€…ä¿®æ”¹å†…éƒ¨ä»£ç ï¼Œä½†æ˜¯åœ¨æ¯æ¬¡æ„å»ºçš„æ—¶å€™ï¼Œè¿™äº›ä»£ç éƒ½ä¼šé‡æ–°ç¼–è¯‘å’Œæ‰“åŒ…ï¼Œè¿™æ ·å°±å¾ˆæµªè´¹æ—¶é—´ï¼Œwebpack.DllPluginå°±æ˜¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„æ’ä»¶ï¼Œä½¿ç”¨å®ƒå¯ä»¥åœ¨ç¬¬ä¸€æ¬¡ç¼–è¯‘æ‰“åŒ…åå°±ç”Ÿæˆä¸€ä»½ä¸å˜çš„ä»£ç ä¾›å…¶ä»–æ¨¡å—å¼•ç”¨ï¼Œè¿™æ ·ä¸‹ä¸€æ¬¡æ„å»ºçš„æ—¶å€™å°±å¯ä»¥èŠ‚çœå¼€å‘æ—¶ç¼–è¯‘æ‰“åŒ…çš„æ—¶é—´ã€‚

// è¦ä½¿ç”¨DllPluginçš„åŠŸèƒ½ï¼Œéœ€è¦é…åˆwebpack.DllReferencePluginæ¥ä½¿ç”¨ã€‚

// DLLPlugin è¿™ä¸ªæ’ä»¶æ˜¯åœ¨ä¸€ä¸ªé¢å¤–ç‹¬ç«‹çš„ Webpack è®¾ç½®ä¸­åˆ›å»ºä¸€ä¸ªåªæœ‰å…¬å…±åº“çš„ dll æ–‡ä»¶ï¼Œè¿™æ—¶å€™æˆ‘ä»¬é¡¹ç›®ä¸­åº”è¯¥å•ç‹¬ä¸º dll æ–‡ä»¶åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚webpack.config.dll.jsï¼Œwebpack.config.dll.js ä½œç”¨æ˜¯æŠŠæ‰€æœ‰çš„ç¬¬ä¸‰æ–¹åº“ä¾èµ–æ‰“åŒ…åˆ°ä¸€ä¸ª bundle çš„ dll æ–‡ä»¶é‡Œé¢ï¼Œè¿˜ä¼šç”Ÿæˆä¸€ä¸ªåä¸º manifest.json æ–‡ä»¶ã€‚ç”Ÿæˆçš„ manifest.json ä¼šè®© DllReferencePluginåœ¨webpack.config.jsé…ç½®ä¸­æ˜ å°„åˆ°ç›¸å…³çš„ä¾èµ–ä¸Šå»çš„ã€‚

// DllReferencePlugin è¿™ä¸ªæ’ä»¶æ˜¯åœ¨ webpack.config.js ä¸­ä½¿ç”¨çš„ï¼Œè¯¥æ’ä»¶çš„ä½œç”¨æ˜¯æŠŠåˆšåˆšåœ¨ webpack.config.dll.js ä¸­æ‰“åŒ…ç”Ÿæˆçš„ dll æ–‡ä»¶å¼•ç”¨åˆ°éœ€è¦çš„é¢„ç¼–è¯‘çš„ä¾èµ–ä¸Šæ¥ã€‚ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå°±æ˜¯è¯´ï¼Œå‡è®¾åœ¨ webpack.config.dll.js ä¸­æ‰“åŒ…åä¼šç”Ÿæˆ dll.js æ–‡ä»¶å’Œ manifest.jsonä¸¤ä¸ªæ–‡ä»¶ï¼Œdll.js æ–‡ä»¶åŒ…å«æ‰€æœ‰çš„ç¬¬ä¸‰æ–¹åº“æ–‡ä»¶ï¼Œmanifest.json æ–‡ä»¶ä¼šåŒ…å«æ‰€æœ‰åº“ä»£ç çš„ä¸€ä¸ªç´¢å¼•ï¼Œå½“åœ¨ä½¿ç”¨ webpack.config.js æ–‡ä»¶æ‰“åŒ… DllReferencePlugin æ’ä»¶çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨è¯¥ DllReferencePlugin æ’ä»¶è¯»å– vendor-manifest.json æ–‡ä»¶ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰è¯¥ç¬¬ä¸‰æ–¹åº“ã€‚manifest.json æ–‡ä»¶å°±æ˜¯æœ‰ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“çš„ä¸€ä¸ªæ˜ å°„è€Œå·²ã€‚

// å½“ç¬¬ä¸€æ¬¡ä½¿ç”¨ webpack.config.dll.js æ–‡ä»¶ä¼šå¯¹ç¬¬ä¸‰æ–¹åº“æ‰“åŒ…ï¼Œæ‰“åŒ…å®Œæˆåå°±ä¸ä¼šå†æ‰“åŒ…å®ƒäº†ï¼Œç„¶åæ¯æ¬¡è¿è¡Œ webpack.config.js æ–‡ä»¶çš„æ—¶å€™ï¼Œéƒ½ä¼šæ‰“åŒ…é¡¹ç›®ä¸­æœ¬èº«çš„æ–‡ä»¶ä»£ç ï¼Œå½“éœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹ä¾èµ–çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨ DllReferencePlugin æ’ä»¶å»è¯»å–ç¬¬ä¸‰æ–¹ä¾èµ–åº“ï¼Œè€Œåªæœ‰æˆ‘ä»¬ä¿®æ”¹ç¬¬ä¸‰æ–¹å…¬å…±åº“çš„æ—¶å€™ï¼Œæ‰ä¼šæ‰§è¡Œwebpack.config.dll.jsã€‚æœ¬è´¨ä¸Šæ¥è¯´ DLL æ–¹æ¡ˆå°±æ˜¯ä¸€ç§ç¼“å­˜æœºåˆ¶ã€‚

// Tipsï¼šDLL æ˜¯åŠ¨æ€é“¾æ¥åº“ï¼ˆDynamic-link libraryï¼‰çš„è‹±æ–‡ç¼©å†™ï¼Œæœ€æ—©æ˜¯å¾®è½¯æå‡ºæ¥çš„ä¸€ç§å…±äº«å‡½æ•°åº“æ¦‚å¿µï¼Œå®é™…å°±æ˜¯å°†ä¸€äº›ç»å¸¸ä¼šå…±äº«çš„ä»£ç åˆ¶ä½œæˆ DLL æ–‡æ¡£ï¼Œå½“å…¶ä»–ä»£ç éœ€è¦ä½¿ç”¨è¿™äº› DLL ä¸­çš„ä»£ç æ—¶ï¼ŒWindows æ“ä½œç³»ç»Ÿä¼šå°† DLL æ–‡æ¡£åŠ è½½åˆ°å†…å­˜ä¸­ã€‚è¿™é‡Œå€Ÿç”¨äº† DLL çš„æ¦‚å¿µï¼Œå¸®åŠ© Webpack ä½¿ç”¨è€…ç†è§£ç”¨é€”ã€‚

// æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹çœ‹å…·ä½“æ€ä¹ˆé…ç½®ï¼Œé¦–å…ˆæˆ‘ä»¬çš„src/index.jsæŒ‰ç…§æ­£å¸¸ä»£ç å†™æ³•å³å¯ï¼Œä¾‹å¦‚å†…å®¹å¦‚ä¸‹ï¼š

// import React, {Component} from 'react';
// import ReactDOM, {render} from 'react-dom';

// console.log(React, Component, ReactDOM, render, 'hell dll');
// ç„¶åæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªwebpack.config.dll.jsï¼Œè¿™é‡Œé¢æ·»åŠ äº†æˆ‘ä»¬éœ€è¦æ‰“åŒ…çš„ç¬¬ä¸‰æ–¹ä¾èµ–åº“ react å’Œ react-domï¼š

// // webpack.config.dll.js
// const webpack = require('webpack');
// // è¿™é‡Œæ˜¯ç¬¬ä¸‰æ–¹ä¾èµ–åº“
// const vendors = ['react', 'react-dom'];

// module.exports = {
//     mode: 'production',
//     entry: {
//         // å®šä¹‰ç¨‹åºä¸­æ‰“åŒ…å…¬å…±æ–‡ä»¶çš„å…¥å£æ–‡ä»¶vendor.js
//         vendor: vendors
//     },
//     output: {
//         filename: '[name].[chunkhash].js',
//         // è¿™é‡Œæ˜¯ä½¿ç”¨å°† verdor ä½œä¸º library å¯¼å‡ºï¼Œå¹¶ä¸”æŒ‡å®šå…¨å±€å˜é‡åå­—æ˜¯[name]_[chunkhash]
//         library: '[name]_[chunkhash]'
//     },
//     plugins: [
//         new webpack.DllPlugin({
//             // è¿™é‡Œæ˜¯è®¾ç½® mainifest.json è·¯å¾„
//             path: 'manifest.json',
//             name: '[name]_[chunkhash]',
//             context: __dirname
//         })
//     ]
// };
// è¿™æ—¶å€™æ‰§è¡Œwebpack --config webpack.config.dll.jsï¼Œæ˜¾ç¤ºæ‰“åŒ…æˆåŠŸï¼š


// æŸ¥çœ‹ä¸€ä¸‹ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

// â”œâ”€â”€ dist
// â”‚   â””â”€â”€ vendor.1c25daba4f58872736ee.js # è¿™ä¸ªæ˜¯åˆšåˆšæ‰“åŒ…å‡ºæ¥çš„ dll æ–‡ä»¶
// â”œâ”€â”€ manifest.json    # è¿™ä¸ªæ˜¯é…ç½®æ–‡ä»¶ï¼Œåç»­è¦ç”¨
// â”œâ”€â”€ node_modules
// â”œâ”€â”€ package.json
// â”œâ”€â”€ src
// â”‚   â””â”€â”€ index.js
// â”œâ”€â”€ webpack.config.dll.js # dll é…ç½®
// â””â”€â”€ webpack.config.js # æ™®é€šé…ç½®
// ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹æ­£å¸¸é¡¹ç›®çš„é…ç½®æ–‡ä»¶webpack.config.jsæ˜¯æ€ä¹ˆé…ç½®çš„ï¼Œwebpack.config.jsä¸­æˆ‘ä»¬éœ€è¦ä½¿ç”¨DllReferencePluginæŒ‡å®šmanifest.jsonçš„å†…å®¹å³å¯ï¼š

// // webpack.config.js
// const webpack = require('webpack');

// module.exports = {
//     output: {
//         filename: '[name].[chunkhash].js'
//     },
//     entry: {
//         app: './src/index.js'
//     },
//     plugins: [
//         new webpack.DllReferencePlugin({
//             context: __dirname,
//             // è¿™é‡Œå¯¼å…¥ manifesté…ç½®å†…å®¹
//             manifest: require('./manifest.json')
//         })
//     ]
// };
// è¿™æ—¶å€™æ‰§è¡Œwebpackå‘½ä»¤å°±å¯ä»¥ç”Ÿæˆapp.jsæ–‡ä»¶äº†ï¼Œå¹¶ä¸”app.jså¹¶ä¸ä¼šåŒ…å« dll æ‰“åŒ…å‡ºæ¥çš„vendor.jsæ–‡ä»¶å†…å®¹ï¼Œæ‰“åŒ…é€Ÿåº¦ä¹Ÿæå‡äº†ä¸å°‘ï¼

// Tipsï¼šåœ¨å®é™…æ“ä½œä¸­ï¼ŒHTML ä¸­ä¸ä¼šä¸»åŠ¨å¼•å…¥ dll çš„ vendor.js æ–‡ä»¶ï¼Œè¿™æ—¶å€™éœ€è¦æˆ‘ä»¬æƒ³åŠæ³•æ‰‹åŠ¨æˆ–è€…é€šè¿‡æ’ä»¶æ·»åŠ è¿›å»ï¼Œæ¯”å¦‚ä½¿ç”¨add-asset-html-webpack-pluginï¼Œæˆ–è€…åœ¨ dll æ‰“åŒ…çš„æ—¶å€™å°±ä¿®æ”¹ä¸€ä¸‹ html-webpack-plugin çš„ template æ–‡ä»¶ï¼Œæ­£å¸¸æ‰“åŒ…çš„æ—¶å€™ç›´æ¥ä½¿ç”¨è¿™ä¸ª template æ–‡ä»¶å†æ‰“åŒ…ä¸€æ¬¡å³å¯ã€‚